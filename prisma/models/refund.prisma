// 退款记录表
model OrderRefund {
    id                 String    @id @default(cuid()) // 内部主键
    afterSaleCode      String? // 售后编号
    orderId            String? // 所属订单ID
    submittedAt        DateTime? // 提交时间
    refundedAt         DateTime? // 退款时间
    refundChannel      String? // 退款渠道枚举值，如 '抖音平台退款'
    approvalUrl        String? // 审批链接
    createdBy          String? // 登记人（系统用户ID）
    refundAmount       Decimal?  @db.Decimal(10, 2) // 退款金额
    refundReason       String? // 退款原因描述
    benefitEndedAt     DateTime? @db.Date // 权益终止时间
    benefitUsedDays    Int? // 实际权益使用天数
    applicantName      String? // 申请人姓名
    isFinancialSettled Boolean   @default(false) // 财务结算状态
    financialSettledAt DateTime? @db.Date // 财务结算时间
    financialNote      String? // 结算备注
    parentId           String? // 父退款记录ID（如有）
    productCategory    String? // 产品类别（冗余存储）
    createdAt          DateTime  @default(now()) // 创建时间
    updatedAt          DateTime  @updatedAt // 更新时间

    // 关联关系
    order        Order?        @relation(fields: [orderId], references: [id])
    creator      User?         @relation("RefundCreator", fields: [createdBy], references: [id])
    parentRefund OrderRefund?  @relation("RefundHierarchy", fields: [parentId], references: [id])
    childRefunds OrderRefund[] @relation("RefundHierarchy")

    @@index([orderId]) // 订单退款查询
    @@index([createdBy]) // 创建人查询
    @@index([isFinancialSettled]) // 财务结算状态
    @@index([submittedAt]) // 提交时间查询
}
